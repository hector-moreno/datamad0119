# MySQL Select
# Challenge 1

USE publications;
SELECT auth.au_id 'AUTHOR ID', auth.au_lname 'LAST NAME', auth.au_fname 'FIRST NAME', tit.title 'TITLE', pub.pub_name 'PUBLISHER' 
FROM publications.authors auth
LEFT JOIN publications.titleauthor titaut
ON auth.au_id = titaut.au_id
LEFT JOIN publications.titles tit
ON titaut.title_id = tit.title_id
LEFT JOIN publications.publishers pub
ON tit.pub_id = pub.pub_id;

# Challenge 2

USE publications;
SELECT auth.au_id 'AUTHOR ID', auth.au_lname 'LAST NAME', auth.au_fname 'FIRST NAME', pub.pub_name 'PUBLISHER', COUNT(tit.title) AS 'TITLE COUNT'
FROM publications.authors auth
LEFT JOIN publications.titleauthor titaut
ON auth.au_id = titaut.au_id
LEFT JOIN publications.titles tit
ON titaut.title_id = tit.title_id
LEFT JOIN publications.publishers pub
ON tit.pub_id = pub.pub_id
GROUP BY auth.au_id, auth.au_lname, auth.au_fname, pub.pub_name;

# Challenge 3
USE publications;
SELECT auth.au_id 'AUTHOR ID', auth.au_lname 'LAST NAME', auth.au_fname 'FIRST NAME', SUM(sal.qty) AS 'TOTAL'
FROM publications.authors auth
LEFT JOIN publications.titleauthor titaut
ON auth.au_id = titaut.au_id
LEFT JOIN publications.titles tit
ON titaut.title_id = tit.title_id
LEFT JOIN publications.sales sal
ON titaut.title_id = sal.title_id
GROUP BY auth.au_id, auth.au_lname, auth.au_fname
LIMIT 3;

# Challenge 4
USE publications;
SELECT auth.au_id 'AUTHOR ID', auth.au_lname 'LAST NAME', auth.au_fname 'FIRST NAME', SUM(sal.qty) AS 'TOTAL'
FROM publications.authors auth
LEFT JOIN publications.titleauthor titaut
ON auth.au_id = titaut.au_id
LEFT JOIN publications.titles tit
ON titaut.title_id = tit.title_id
LEFT JOIN publications.sales sal
ON titaut.title_id = sal.title_id
GROUP BY auth.au_id, auth.au_lname, auth.au_fname
ORDER BY SUM(sal.qty) DESC   
LIMIT 23;
